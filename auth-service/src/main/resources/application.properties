# ========================================
# APPLICATION CONFIGURATION
# ========================================
quarkus.application.name=auth-service
quarkus.http.port=${PORT:8080}

# Mapping Environment Variables to App Properties
app.backend.url=${BACKEND_URL:http://localhost:8080}
app.frontend.url=${FRONTEND_URL:http://localhost:3000}

# ========================================
# DATABASE CONFIGURATION
# ========================================
quarkus.datasource.db-kind=postgresql
quarkus.datasource.jdbc.driver=org.postgresql.Driver

# Default (Development) - Local PostgreSQL
quarkus.datasource.jdbc.url=jdbc:postgresql://localhost:5432/authentication
quarkus.datasource.username=postgres
quarkus.datasource.password=12lpactc

# Production - Port updated to 5432 for Session Pooling compatibility
%prod.quarkus.datasource.jdbc.url=${DATABASE_URL}
%prod.quarkus.datasource.username=${DATABASE_USERNAME}
%prod.quarkus.datasource.password=${DATABASE_PASSWORD}

# Connection Pool
quarkus.datasource.jdbc.min-size=2
quarkus.datasource.jdbc.max-size=8

# ========================================
# HIBERNATE ORM CONFIGURATION
# ========================================
quarkus.hibernate-orm.log.sql=true
quarkus.hibernate-orm.log.format-sql=true
# Use 'update' for dev; 'none' or 'validate' is safer for production
quarkus.hibernate-orm.database.generation=update

%prod.quarkus.hibernate-orm.log.sql=false
%prod.quarkus.hibernate-orm.log.format-sql=false

# ========================================
# SECURITY & AUTHENTICATION
# ========================================
quarkus.http.auth.permission.public.paths=/api/auth/signup,/api/auth/login,/api/auth/verify,/api/auth/resend-verification
quarkus.http.auth.permission.public.policy=permit

quarkus.http.auth.permission.swagger.paths=/q/swagger-ui/*,/q/openapi
quarkus.http.auth.permission.swagger.policy=permit

quarkus.http.auth.permission.health.paths=/q/health/*
quarkus.http.auth.permission.health.policy=permit

quarkus.http.auth.permission.authenticated.paths=/*
quarkus.http.auth.permission.authenticated.policy=authenticated

# ========================================
# CORS CONFIGURATION
# ========================================
quarkus.http.cors."*".origins=http://localhost:3000,http://localhost:5173,http://localhost:3001
quarkus.http.cors."*".methods=GET,POST,PUT,DELETE,OPTIONS
quarkus.http.cors."*".headers=accept,authorization,content-type,x-requested-with
quarkus.http.cors."*".access-control-allow-credentials=true

%prod.quarkus.http.cors."*".origins=https://oppenxai-auth-service.vercel.app,https://auth-service-qav9.onrender.com,https://auth-frontend-swo7.onrender.com

# Resend Configuration
resend.api.key=${RESEND_API_KEY}

# ========================================
# TEST CONFIGURATION
# ========================================
%test.quarkus.datasource.db-kind=h2
%test.quarkus.datasource.jdbc.url=jdbc:h2:mem:testdb
%test.quarkus.hibernate-orm.database.generation=drop-and-create
%test.quarkus.mailer.mock=true