# ========================================
# APPLICATION CONFIGURATION
# ========================================
quarkus.application.name=auth-service
quarkus.http.port=${PORT:8080}

# ========================================
# DATABASE CONFIGURATION
# ========================================
quarkus.datasource.db-kind=postgresql
quarkus.datasource.jdbc.driver=org.postgresql.Driver

# Default (Development) - Local PostgreSQL
quarkus.datasource.jdbc.url=jdbc:postgresql://localhost:5432/authentication
quarkus.datasource.username=postgres
quarkus.datasource.password=12lpactc

# Production - Environment variables (set in Render dashboard)
%prod.quarkus.datasource.jdbc.url=${DATABASE_URL}
%prod.quarkus.datasource.username=${DATABASE_USERNAME}
%prod.quarkus.datasource.password=${DATABASE_PASSWORD}

# Connection Pool
quarkus.datasource.jdbc.min-size=2
quarkus.datasource.jdbc.max-size=8

# ========================================
# HIBERNATE ORM CONFIGURATION
# ========================================
quarkus.hibernate-orm.log.sql=true
quarkus.hibernate-orm.log.format-sql=true
quarkus.hibernate-orm.database.generation=update

# Production - Disable SQL logging
%prod.quarkus.hibernate-orm.log.sql=false
%prod.quarkus.hibernate-orm.log.format-sql=false
%prod.quarkus.hibernate-orm.database.generation=update

# ========================================
# SECURITY & AUTHENTICATION
# ========================================
# Allow public access to authentication endpoints
quarkus.http.auth.permission.public.paths=/api/auth/signup,/api/auth/login,/api/auth/verify,/api/auth/resend-verification
quarkus.http.auth.permission.public.policy=permit

# Swagger UI and OpenAPI - public access
quarkus.http.auth.permission.swagger.paths=/q/swagger-ui/*,/q/openapi
quarkus.http.auth.permission.swagger.policy=permit

# Health checks - public access
quarkus.http.auth.permission.health.paths=/q/health/*
quarkus.http.auth.permission.health.policy=permit

# All other paths require authentication
quarkus.http.auth.permission.authenticated.paths=/*
quarkus.http.auth.permission.authenticated.policy=authenticated

# ========================================
# CORS CONFIGURATION
# ========================================
# Configure CORS with named configuration
quarkus.http.cors."*".origins=http://localhost:3000,http://localhost:5173,http://localhost:3001
quarkus.http.cors."*".methods=GET,POST,PUT,DELETE,OPTIONS
quarkus.http.cors."*".headers=accept,authorization,content-type,x-requested-with
quarkus.http.cors."*".exposed-headers=Content-Disposition
quarkus.http.cors."*".access-control-max-age=24H
quarkus.http.cors."*".access-control-allow-credentials=true

# Production CORS
%prod.quarkus.http.cors."*".origins=https://oppenxai-auth-service.vercel.app,https://auth-service-qav9.onrender.com,https://auth-frontend-swo7.onrender.com

# ========================================
# EMAIL CONFIGURATION - Gmail SMTP
# ========================================
quarkus.mailer.from=ishrut.malviya29@gmail.com
quarkus.mailer.host=smtp.gmail.com
quarkus.mailer.port=587
quarkus.mailer.start-tls=REQUIRED
quarkus.mailer.username=ishrut.malviya29@gmail.com
quarkus.mailer.password=wukqhkrnwjyebggb
quarkus.mailer.mock=false

# Production - Use environment variables for security
%prod.quarkus.mailer.password=${EMAIL_PASSWORD:wukqhkrnwjyebggb}

# ========================================
# TEST CONFIGURATION
# ========================================
# Test Database (H2 in-memory)
%test.quarkus.datasource.db-kind=h2
%test.quarkus.datasource.username=sa
%test.quarkus.datasource.password=
%test.quarkus.datasource.jdbc.url=jdbc:h2:mem:testdb
%test.quarkus.datasource.jdbc.driver=org.h2.Driver

# Hibernate for Tests
%test.quarkus.hibernate-orm.database.generation=drop-and-create
%test.quarkus.hibernate-orm.log.sql=false
%test.quarkus.hibernate-orm.sql-load-script=no-file

# Disable Dev Services in Tests
%test.quarkus.devservices.enabled=false

# Test Logging
%test.quarkus.log.level=INFO
%test.quarkus.log.category."org.oppexai".level=DEBUG

# Mock email in tests
%test.quarkus.mailer.mock=true

